<script>
    const nameToId = {};
    const buttons = document.querySelectorAll('input[type="button"]');

    // Funzione per mostrare messaggi di stato
    function showStatus(message, isSuccess = true) {
        const statusMessage = document.getElementById('statusMessage');
        statusMessage.textContent = message;
        statusMessage.style.color = isSuccess ? '#4CAF50' : '#f44336';
        statusMessage.style.display = 'inline';
        setTimeout(() => {
            statusMessage.style.display = 'none';
        }, 3000);
    }

    function salvaDati() {
        const dataValue = document.getElementById('data').value;

        const data = {
            inizio: dataValue
        };

        buttons.forEach(b => b.disabled = true);
        showStatus("Salvataggio in corso...", true);

        google.script.run
            .withSuccessHandler(function() {
                const checkmark = document.getElementById('checkmark');
                checkmark.style.display = 'inline';
                showStatus("Salvataggio completato!", true);

                setTimeout(() => {
                    checkmark.style.display = 'none';
                    buttons.forEach(b => b.disabled = false);

                    document.getElementById('data').value = "";
                }, 2000);
            })
            .withFailureHandler(function(err) {
                console.error('Errore addAnno:', err);
                showStatus("Errore salvataggio anno.", false);
                buttons.forEach(b => b.disabled = false);
            })
            .addAnno(data);
    }
</script>